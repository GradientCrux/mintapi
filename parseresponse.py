import datetime
from genericpath import sameopenfile
from re import sub
from sqlalchemy import create_engine
import psycopg2

import pprint as pp
import pandas as pd


r = [{'linkedAccountId': None, 'accountName': 'Acorns', 'addAccountDate': 1506502661000, 'fiLoginDisplayName': 'Acorns', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625244494000, 'fiLastUpdated': 1625244494000, 'yodleeAccountNumberLast4': 'Acorns', 'isError': False, 'fiName': 'Acorns', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '23 hours', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6474862, 'isHostAccount': False, 'value': 0.0, 'fiLoginId': 2822416, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 0.0, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Acorns', 'closeDate': 1625244493000, 'linkStatus': 'NOT_LINKED', 'accountId': 6474862, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75121888774, 'name': 'Acorns', 'status': '1', 'addAccountDateInDate': datetime.datetime(2017, 9, 27, 3, 57, 41), 'closeDateInDate': datetime.datetime(2021, 7, 2, 11, 48, 13), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 2, 11, 48, 14), 'lastUpdatedInDate': datetime.datetime(2021, 7, 2, 11, 48, 14), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Bonvoy Amex Card', 'addAccountDate': 1549471166000, 'fiLoginDisplayName': 'American Express Credit Card (US)', 'ccAggrStatus': 0, 'dueDate': '07/21/2021', 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312493000, 'fiLastUpdated': 1625312493000, 'yodleeAccountNumberLast4': 'XXXX-XXXXXX-X1003', 'isError': False, 'fiName': 'American Express Credit Card', 'isAccountNotFound': False, 'klass': 'credit', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 3, 'currency': 'USD', 'id': 6644935, 'isHostAccount': False, 'value': -2008.34, 'fiLoginId': 2874078, 'usageType': None, 'interestRate': 0.0, 'accountType': 'credit', 'currentBalance': 2008.34, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Bonvoy Amex Card', 'closeDate': 1625312487000, 'linkStatus': 'NOT_LINKED', 'dueAmt': 0, 'accountId': 6644935, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75391669130, 'name': 'Bonvoy Amex Card', 'status': '1', 'addAccountDateInDate': datetime.datetime(2019, 2, 6, 10, 39, 26), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 27), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 33), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 33), 'availableMoney': 7959.0, 'totalFees': 223.53, 'totalCredit': 10000.0, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': 537263, 'accountName': 'Adv Plus Banking - 7830', 'addAccountDate': 1312992563000, 'fiLoginDisplayName': 'Bank of America', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': 1312968038000, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312481000, 'fiLastUpdated': 1625312481000, 'yodleeAccountNumberLast4': 'XXXXXXXX7830', 'isError': False, 'fiName': 'Bank of America', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 2, 'currency': 'USD', 'id': 5003284, 'isHostAccount': False, 'value': 3488.51, 'fiLoginId': 2310973, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 3488.51, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Adv Plus Banking - 7830', 'closeDate': 1625312479000, 'linkStatus': 'LINKED', 'accountId': 5003284, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 31374915, 'name': 'Adv Plus Banking - 7830', 'status': '1', 'addAccountDateInDate': datetime.datetime(2011, 8, 10, 11, 9, 23), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 21), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 21), 'availableMoney': 3488.51, 'totalFees': 1225.68, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'CampusEdge checking-7830', 'addAccountDate': 1250342258000, 'fiLoginDisplayName': 'Bank of America (All except WA & ID)', 'ccAggrStatus': None, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': 1312968038000, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1301504840000, 'fiLastUpdated': 1301504840000, 'yodleeAccountNumberLast4': '7830', 'isError': True, 'fiName': 'Bank of America', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '10 years', 'accountTypeInt': 2, 'currency': 'USD', 'id': 537263, 'isHostAccount': False, 'value': 1029.56, 'fiLoginId': 448313, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 1029.56, 'fiLoginStatus': 'FAILED_TIMED_OUT', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'CampusEdge checking-7830', 'closeDate': 1301504840000, 'linkStatus': 'LINKED', 'accountId': 537263, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_TIMED_OUT', 'yodleeAccountId': 13729722, 'name': 'CampusEdge checking-7830', 'status': '1', 'addAccountDateInDate': datetime.datetime(2009, 8, 15, 8, 17, 38), 'closeDateInDate': datetime.datetime(2011, 3, 30, 12, 7, 20), 'fiLastUpdatedInDate': datetime.datetime(2011, 3, 30, 12, 7, 20), 'lastUpdatedInDate': datetime.datetime(2011, 3, 30, 12, 7, 20), 'availableMoney': 1007.14, 'totalFees': 1225.68, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': 537262, 'accountName': 'Regular Savings', 'addAccountDate': 1312992563000, 'fiLoginDisplayName': 'Bank of America', 'ccAggrStatus': 324, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': 1312968042000, 'isActive': \
True, 'accountStatus': '1', 'accountSystemStatus': 'DEAD', 'lastUpdated': 1625312481000, 'fiLastUpdated': 1625312481000, 'yodleeAccountNumberLast4': '1693', 'isError': False, 'fiName': 'Bank of America', 'isAccountNotFound': True, 'klass': 'bank', \
'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 5, 'currency': 'USD', 'id': 5003285, 'isHostAccount': False, 'value': 123.36, 'fiLoginId': 2310973, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 123.36, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Regular Savings', 'closeDate': 1553436385000, 'linkStatus': 'LINKED', 'accountId': 5003285, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 31374916, 'name': 'Regular Savings', 'status': '1', 'addAccountDateInDate': datetime.datetime(2011, 8, 10, 11, 9, 23), 'closeDateInDate': datetime.datetime(2019, 3, 24, 9, 6, 25), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 21), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 21), 'availableMoney': 123.36, 'totalFees': 18.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Regular Savings-1693', 'addAccountDate': 1250342258000, 'fiLoginDisplayName': 'Bank of America (All except WA & ID)', 'ccAggrStatus': None, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': 1312968042000, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1301504840000, 'fiLastUpdated': 1301504840000, 'yodleeAccountNumberLast4': '1693', 'isError': True, 'fiName': 'Bank of America', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '10 years', 'accountTypeInt': 5, 'currency': 'USD', 'id': 537262, 'isHostAccount': False, 'value': 170.73, 'fiLoginId': 448313, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 170.73, 'fiLoginStatus': 'FAILED_TIMED_OUT', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Regular Savings-1693', 'closeDate': 1301504840000, 'linkStatus': 'LINKED', 'accountId': 537262, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_TIMED_OUT', 'yodleeAccountId': 13729723, 'name': 'Regular Savings-1693', 'status': '1', 'addAccountDateInDate': datetime.datetime(2009, 8, 15, 8, 17, 38), 'closeDateInDate': datetime.datetime(2011, 3, \
30, 12, 7, 20), 'fiLastUpdatedInDate': datetime.datetime(2011, 3, 30, 12, 7, 20), 'lastUpdatedInDate': datetime.datetime(2011, 3, 30, 12, 7, 20), 'availableMoney': 170.73, 'totalFees': 18.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Venture', 'addAccountDate': 1377225821000, 'fiLoginDisplayName': 'Capital One Credit Card', 'ccAggrStatus': 0, 'dueDate': '09/14/2020', 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1598872342000, 'fiLastUpdated': 1598872342000, 'yodleeAccountNumberLast4': 'XXXX5671', 'isError': True, 'fiName': 'Capital One Credit Card', 'isAccountNotFound': False, 'klass': 'credit', 'possibleLinkAccounts': [], 'lastUpdatedInString': '10 months', 'accountTypeInt': 3, 'currency': 'USD', 'id': 6318577, 'isHostAccount': False, 'value': -59.0, 'fiLoginId': 2596056, 'usageType': None, 'interestRate': 0.0, 'accountType': 'credit', 'currentBalance': 59.0, 'fiLoginStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'isAccountClosedByMint': False, 'userName': None, 'statusMessage': 'We cannot connect to your bank. Make sure the login you use there is updated in Mint.', 'yodleeName': 'Venture', 'closeDate': 1598872341000, 'linkStatus': 'NOT_LINKED', 'dueAmt': 0, 'accountId': 6318577, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'yodleeAccountId': 75180217336, 'name': 'Venture', 'status': '1', 'addAccountDateInDate': datetime.datetime(2013, 8, 22, 21, 43, 41), 'closeDateInDate': datetime.datetime(2020, 8, 31, 6, 12, 21), 'fiLastUpdatedInDate': datetime.datetime(2020, 8, 31, 6, 12, 22), 'lastUpdatedInDate': datetime.datetime(2020, 8, 31, 6, 12, 22), 'availableMoney': None, 'totalFees': 1184.82, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'HSA Brokerage', 'addAccountDate': 1451837866000, 'fiLoginDisplayName': 'Charles Schwab (Web Access)', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312484000, 'fiLastUpdated': 1625312484000, 'yodleeAccountNumberLast4': 'XXXX-2015', 'isError': False, 'fiName': 'Charles Schwab', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 1, 'currency': 'USD', 'id': 6834413, 'isHostAccount': False, 'value': 35986.46, 'fiLoginId': 2736814, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 35986.46, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'HSA Brokerage', 'closeDate': 1625312482000, 'linkStatus': 'NOT_LINKED', 'accountId': 6834413, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': -6834413, 'name': 'HSA Brokerage', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 17, 46), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 22), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Individual                       ', 'addAccountDate': 1451837866000, 'fiLoginDisplayName': 'Charles Schwab (Web Access)', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312484000, 'fiLastUpdated': 1625312484000, 'yodleeAccountNumberLast4': 'XXXX-9103', 'isError': False, 'fiName': 'Charles Schwab', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6444597, 'isHostAccount': False, 'value': 32108.4, 'fiLoginId': 2736814, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 32108.4, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Individual                       ', 'closeDate': 1625312482000, 'linkStatus': 'NOT_LINKED', 'accountId': 6444597, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75266705813, 'name': 'Individual                       ', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 17, 46), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 22), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Roth Contributory IRA', 'addAccountDate': 1451837866000, 'fiLoginDisplayName': 'Charles Schwab (Web Access)', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312484000, 'fiLastUpdated': 1625312484000, 'yodleeAccountNumberLast4': 'XXXX-5744', 'isError': False, 'fiName': 'Charles Schwab', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 1, 'currency': 'USD', 'id': \
6825857, 'isHostAccount': False, 'value': 48751.07, 'fiLoginId': 2736814, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 48751.07, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Roth Contributory IRA', 'closeDate': 1625312482000, 'linkStatus': 'NOT_LINKED', 'accountId': 6825857, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': -6825857, 'name': 'Roth Contributory IRA', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 17, 46), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 22), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 24), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'addAccountDate': 1451331975000, 'fiLoginDisplayName': 'Chase Bank', 'dueDate': '02/24/2017', 'isTerminal': True, 'linkCreationTime': None, 'isActive': False, 'lastUpdated': 1625312479000, 'rateType': 2, 'fiName': 'Chase Bank', 'origAmount': 0.0, 'klass': 'loan', 'accountTypeInt': 6, 'id': 6214242, 'fiLoginId': 2735615, 'accountType': 'loan', 'currentBalance': 0, 'fiLoginStatus': 'OK', 'origDate': '09/24/2015', 'linkStatus': 'NOT_LINKED', 'accountId': 6214242, 'yodleeAccountId': 75113917687, 'name': 'CHASE AUTO ACCOUNT', 'status': '3', 'accountName': 'CHASE AUTO ACCOUNT', 'ccAggrStatus': 324, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'accountStatus': '3', 'accountSystemStatus': 'DEAD', 'fiLastUpdated': 1625312479000, 'yodleeAccountNumberLast4': '...5408', 'isError': False, 'isAccountNotFound': False, 'rate': 0.019, 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'currency': 'USD', 'term': 100, 'isHostAccount': False, 'value': 0, 'usageType': None, 'interestRate': 0.019, 'isAccountClosedByMint': True, 'userName': None, 'yodleeName': 'CHASE AUTO ACCOUNT', 'closeDate': 1553347590000, 'dueAmt': 400.43, 'amountDue': 0.0, 'isClosed': True, 'fiLoginUIStatus': 'OK', 'addAccountDateInDate': datetime.datetime(2015, 12, 28, 13, 46, 15), 'closeDateInDate': datetime.datetime(2019, 3, 23, 8, 26, 30), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': 0.0, 'nextPaymentDate': '02/24/2017'}, {'linkedAccountId': None, 'accountName': 'CREDIT CARD', 'addAccountDate': 1451331975000, 'fiLoginDisplayName': 'Chase Bank', 'ccAggrStatus': 0, 'dueDate': '07/02/2021', 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312479000, 'fiLastUpdated': 1625312479000, 'yodleeAccountNumberLast4': '....0995', 'isError': False, 'fiName': 'Chase Bank', 'isAccountNotFound': False, 'klass': 'credit', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 3, 'currency': 'USD', 'id': 6652667, 'isHostAccount': False, 'value': -353.85, 'fiLoginId': \
2735615, 'usageType': None, 'interestRate': 0.2299, 'accountType': 'credit', 'currentBalance': 353.85, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'CREDIT CARD', 'closeDate': 1625312478000, 'linkStatus': 'NOT_LINKED', 'dueAmt': 0.0, 'accountId': 6652667, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75398097885, 'name': 'CREDIT CARD', 'status': '1', 'addAccountDateInDate': datetime.datetime(2015, 12, 28, 13, 46, 15), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 18), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'availableMoney': 12646.15, 'totalFees': 1629.0, 'totalCredit': 13000.0, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'INDIVIDUAL', 'addAccountDate': 1554377683000, 'fiLoginDisplayName': 'Fidelity', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625329614000, 'fiLastUpdated': 1625329614000, 'yodleeAccountNumberLast4': 'XXXXX3249', \
'isError': False, 'fiName': 'Fidelity', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '7 minutes', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6661189, 'isHostAccount': False, 'value': 1962.05, 'fiLoginId': 2879860, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 1962.05, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'INDIVIDUAL', 'closeDate': 1625329613000, 'linkStatus': 'NOT_LINKED', 'accountId': 6661189, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75405403467, 'name': 'INDIVIDUAL', 'status': '1', 'addAccountDateInDate': datetime.datetime(2019, 4, 4, 6, 34, 43), 'closeDateInDate': datetime.datetime(2021, 7, 3, 11, 26, 53), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 11, 26, 54), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 11, 26, 54), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'SLB DSPP', 'addAccountDate': 1554377683000, 'fiLoginDisplayName': 'Fidelity', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': False, 'accountStatus': '3', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625329614000, 'fiLastUpdated': 1625329614000, 'yodleeAccountNumberLast4': 'Employee Stock Purchase Plan', 'isError': False, 'fiName': 'Fidelity', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '7 minutes', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6661188, 'isHostAccount': False, 'value': 0.0, 'fiLoginId': 2879860, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 0, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'SLB DSPP', 'closeDate': 1625329613000, 'linkStatus': 'NOT_LINKED', 'accountId': 6661188, 'isClosed': True, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75405403468, 'name': 'SLB DSPP', 'status': '3', 'addAccountDateInDate': datetime.datetime(2019, 4, 4, 6, 34, 43), 'closeDateInDate': datetime.datetime(2021, 7, 3, 11, 26, 53), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 11, 26, 54), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 11, 26, 54), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'addAccountDate': 1542478253000, 'fiLoginDisplayName': 'Honda Financial Services', 'dueDate': '', 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'lastUpdated': 1625312482000, 'rateType': 2, 'fiName': 'Honda Financial Services', 'origAmount': None, 'klass': 'loan', 'accountTypeInt': 6, 'id': 6622584, 'fiLoginId': 2865925, 'accountType': 'loan', 'currentBalance': 14677.53, 'fiLoginStatus': 'OK', 'origDate': '', 'linkStatus': 'NOT_LINKED', 'accountId': 6622584, 'yodleeAccountId': 75370821235, 'name': '2018 ACCORD', 'status': '1', 'accountName': '2018 ACCORD', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'fiLastUpdated': 1625312482000, 'yodleeAccountNumberLast4': 'XXXXX0727', 'isError': False, 'isAccountNotFound': False, 'rate': None, 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'currency': 'USD', 'term': 100, 'isHostAccount': False, 'value': -14677.53, 'usageType': None, 'interestRate': None, 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': '2018 ACCORD', 'closeDate': 1625312481000, 'dueAmt': 0, 'amountDue': 0.0, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'addAccountDateInDate': datetime.datetime(2018, 11, 17, 12, 10, 53), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 21), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 22), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 22), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': 0.0, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Alight 401K', 'addAccountDate': 1579531375000, 'fiLoginDisplayName': 'Alight 401K', 'ccAggrStatus': None, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1579507200000, 'fiLastUpdated': 1579531375000, 'yodleeAccountNumberLast4': None, 'isError': False, 'isAsset': True, 'fiName': 'Other Property', 'isAccountNotFound': False, 'klass': 'other', 'possibleLinkAccounts': [], 'propertyType': 'a', 'lastUpdatedInString': '1 year', 'accountTypeInt': 3, 'currency': 'USD', 'id': 6743013, 'isHostAccount': False, 'value': 229363.88, 'fiLoginId': 2906296, 'usageType': 'PERSONAL', 'interestRate': None, 'accountType': 'other property', 'currentBalance': 229363.88, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': 'Alight 401K', 'yodleeName': '', 'closeDate': None, 'linkStatus': 'NOT_LINKED', 'accountId': 6743013, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': None, 'name': 'Alight 401K', 'status': '1', 'addAccountDateInDate': datetime.datetime(2020, 1, 20, 8, 42, 55), 'fiLastUpdatedInDate': datetime.datetime(2020, 1, 20, 8, 42, 55), 'lastUpdatedInDate': datetime.datetime(2020, 1, 20, 2, 0), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'HSA - Mercer -  Vangaurd 500 Index Admiral', 'addAccountDate': 1554316830000, 'fiLoginDisplayName': 'HSA - Mercer -  Vangaurd 500 Index Admiral', 'ccAggrStatus': None, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1554274800000, 'fiLastUpdated': 1554316830000, 'yodleeAccountNumberLast4': None, 'isError': False, 'isAsset': True, 'fiName': 'Other Property', 'isAccountNotFound': False, 'klass': 'other', 'possibleLinkAccounts': [], 'propertyType': 'a', 'lastUpdatedInString': '2 years', 'accountTypeInt': 3, 'currency': 'USD', 'id': 6661050, 'isHostAccount': False, 'value': 23906.99, 'fiLoginId': 2879819, 'usageType': 'PERSONAL', 'interestRate': None, 'accountType': 'other property', 'currentBalance': 23906.99, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': 'HSA - Mercer -  Vangaurd 500 Index Admiral', 'yodleeName': '', 'closeDate': None, 'linkStatus': 'NOT_LINKED', 'accountId': 6661050, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': None, 'name': 'HSA - Mercer -  Vangaurd 500 Index Admiral', 'status': '1', 'addAccountDateInDate': datetime.datetime(2019, 4, 3, 13, 40, 30), 'fiLastUpdatedInDate': \
datetime.datetime(2019, 4, 3, 13, 40, 30), 'lastUpdatedInDate': datetime.datetime(2019, 4, 3, 2, 0), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'CAMERON INTERNATIONAL CORP RETIREMENT SAVINGS PLAN', 'addAccountDate': 1377227223000, 'fiLoginDisplayName': 'T. Rowe Price Retirement Plan Services', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312494000, 'fiLastUpdated': 1625312494000, 'yodleeAccountNumberLast4': 'CAMERON INTERNATIONAL CORP RETIREMENT SAVINGS PLAN', 'isError': False, 'fiName': 'T. Rowe Price Retirement Plan Services', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 1, 'currency': 'USD', \
'id': 5721028, 'isHostAccount': False, 'value': 0.0, 'fiLoginId': 2596061, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 0.0, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'CAMERON INTERNATIONAL CORP RETIREMENT SAVINGS PLAN', 'closeDate': 1625312493000, 'linkStatus': 'NOT_LINKED', 'accountId': 5721028, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75032077416, 'name': 'CAMERON INTERNATIONAL CORP \
RETIREMENT SAVINGS PLAN', 'status': '1', 'addAccountDateInDate': datetime.datetime(2013, 8, 22, 22, 7, 3), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 33), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 34), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 34), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'TD Ameritrade', 'addAccountDate': 1506950487000, 'fiLoginDisplayName': 'TD Ameritrade', 'ccAggrStatus': 324, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': False, 'accountStatus': '3', 'accountSystemStatus': 'DEAD', 'lastUpdated': 1576509346000, 'fiLastUpdated': 1576509346000, 'yodleeAccountNumberLast4': '127133390', 'isError': False, 'fiName': 'TD Ameritrade', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '1 year', 'accountTypeInt': 1, 'currency': 'USD', 'id': 6476733, 'isHostAccount': False, 'value': 8477.91, 'fiLoginId': 2822882, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 0, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': True, 'userName': None, 'yodleeName': 'TD Ameritrade', 'closeDate': 1512265729000, 'linkStatus': 'NOT_LINKED', 'accountId': 6476733, 'isClosed': True, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75288465744, 'name': 'TD Ameritrade', 'status': '3', 'addAccountDateInDate': datetime.datetime(2017, 10, 2, 8, 21, 27), 'closeDateInDate': datetime.datetime(2017, 12, 2, 19, 48, 49), 'fiLastUpdatedInDate': datetime.datetime(2019, 12, 16, 9, 15, 46), 'lastUpdatedInDate': datetime.datetime(2019, 12, 16, 9, 15, 46), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Honda Accord', 'addAccountDate': 1542478440000, 'fiLoginDisplayName': 'Honda Accord', 'ccAggrStatus': None, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'useKBB': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625214369000, 'fiLastUpdated': 1625214369000, 'yodleeAccountNumberLast4': None, 'isError': False, 'fiName': 'Vehicle', 'isAccountNotFound': False, 'klass': 'vehicle', 'possibleLinkAccounts': [], 'lastUpdatedInString': '1 day', 'accountTypeInt': 1, 'currency': 'USD', 'id': 6622586, 'isHostAccount': False, 'value': 30355, 'fiLoginId': 2865927, 'usageType': 'PERSONAL', 'interestRate': None, 'accountType': 'vehicle', 'currentBalance': 30355, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': 'Honda Accord', 'yodleeName': '', 'closeDate': None, 'linkStatus': 'NOT_LINKED', 'accountId': 6622586, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': None, 'name': 'Honda Accord', 'status': '1', 'addAccountDateInDate': datetime.datetime(2018, 11, 17, 12, 14), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 2, 3, 26, 9), 'lastUpdatedInDate': datetime.datetime(2021, 7, 2, 3, 26, 9), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Venmo', 'addAccountDate': 1451954048000, 'fiLoginDisplayName': 'Venmo', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1625312480000, 'fiLastUpdated': 1625312480000, 'yodleeAccountNumberLast4': 'XXXXXXXXXXXXXXX0264', 'isError': False, 'fiName': 'Venmo', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 2, 'currency': 'USD', 'id': 6219367, 'isHostAccount': False, 'value': 662.35, 'fiLoginId': 2737186, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 662.35, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'Venmo', 'closeDate': 1625312479000, 'linkStatus': 'NOT_LINKED', 'accountId': 6219367, 'isClosed': False, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': 75117763654, 'name': 'Venmo', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 4, 18, 34, 8), 'closeDateInDate': datetime.datetime(2021, 7, 3, 6, 41, 19), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 20), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 20), 'availableMoney': 662.35, 'totalFees': 55.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Venmo', 'addAccountDate': 1451954048000, 'fiLoginDisplayName': 'Venmo', 'ccAggrStatus': 324, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': False, 'accountStatus': '3', 'accountSystemStatus': 'DEAD', 'lastUpdated': 1625312480000, 'fiLastUpdated': 1625312480000, 'yodleeAccountNumberLast4': 'XXXXXXXXXXXXXXX0264', 'isError': False, 'fiName': 'Venmo', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '4 hours', 'accountTypeInt': 2, 'currency': 'USD', 'id': 6880932, 'isHostAccount': False, 'value': 51.35, 'fiLoginId': 2737186, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 0, 'fiLoginStatus': 'OK', 'isAccountClosedByMint': True, 'userName': None, 'yodleeName': 'Venmo', 'closeDate': 1621452321000, 'linkStatus': 'NOT_LINKED', 'accountId': 6880932, 'isClosed': True, 'fiLoginUIStatus': 'OK', 'yodleeAccountId': -6880932, 'name': 'Venmo', 'status': '3', 'addAccountDateInDate': datetime.datetime(2016, 1, 4, 18, 34, 8), 'closeDateInDate': datetime.datetime(2021, 5, 19, 14, 25, 21), 'fiLastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 20), 'lastUpdatedInDate': datetime.datetime(2021, 7, 3, 6, 41, 20), 'availableMoney': 0.0, 'totalFees': 0.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'Individual Cash Account', 'addAccountDate': 1451837309000, 'fiLoginDisplayName': 'Wealthfront', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1595796787000, 'fiLastUpdated': 1595796787000, 'yodleeAccountNumberLast4': 'Individual Cash Account', 'isError': True, \
'fiName': 'Wealthfront', 'isAccountNotFound': False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '11 months', 'accountTypeInt': 5, 'currency': 'USD', 'id': 6681408, 'isHostAccount': False, 'value': 20.31, 'fiLoginId': 2736811, 'usageType': None, 'interestRate': 0.0, 'accountType': 'bank', 'currentBalance': 20.31, 'fiLoginStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'isAccountClosedByMint': False, 'userName': None, 'statusMessage': 'We cannot connect to your bank. Make \
sure the login you use there is updated in Mint.', 'yodleeName': 'Individual Cash Account', 'closeDate': 1595707164000, 'linkStatus': 'NOT_LINKED', 'accountId': 6681408, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'yodleeAccountId': 75418232923, 'name': 'Individual Cash Account', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 8, 29), 'closeDateInDate': datetime.datetime(2020, 7, 25, 14, 59, 24), 'fiLastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'lastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'availableMoney': 20.31, 'totalFees': 0.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'My Personal Cash Account', 'addAccountDate': 1451837309000, 'fiLoginDisplayName': 'Wealthfront', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1595796787000, 'fiLastUpdated': 1595796787000, 'yodleeAccountNumberLast4': 'My Personal Cash Account', 'isError': True, 'fiName': 'Wealthfront', 'isAccountNotFound': \
False, 'klass': 'bank', 'possibleLinkAccounts': [], 'lastUpdatedInString': '11 months', 'accountTypeInt': 5, 'currency': 'USD', 'id': 6701773, 'isHostAccount': False, 'value': 7012.67, 'fiLoginId': 2736811, 'usageType': None, 'interestRate': 0.0035, 'accountType': 'bank', 'currentBalance': 7012.67, 'fiLoginStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'My Personal Cash Account', 'closeDate': 1595707164000, 'linkStatus': 'NOT_LINKED', 'accountId': 6701773, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'yodleeAccountId': -6701773, 'name': 'My Personal Cash Account', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 8, 29), 'closeDateInDate': datetime.datetime(2020, 7, 25, 14, 59, 24), 'fiLastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'lastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'availableMoney': 7012.67, 'totalFees': 0.0, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'My Personal Investment Account', 'addAccountDate': 1451837309000, 'fiLoginDisplayName': 'Wealthfront', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1595796787000, 'fiLastUpdated': 1595796787000, 'yodleeAccountNumberLast4': 'My Personal Investment Account', 'isError': True, 'fiName': 'Wealthfront', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '11 months', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6655506, 'isHostAccount': False, 'value': 3132.8, 'fiLoginId': 2736811, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 3132.8, 'fiLoginStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'My Personal Investment Account', 'closeDate': 1595707164000, 'linkStatus': 'NOT_LINKED', 'accountId': 6655506, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'yodleeAccountId': 75400397087, 'name': 'My Personal Investment Account', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 8, 29), 'closeDateInDate': datetime.datetime(2020, 7, 25, 14, 59, 24), 'fiLastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'lastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}, {'linkedAccountId': None, 'accountName': 'My Roth IRA', \
'addAccountDate': 1451837309000, 'fiLoginDisplayName': 'Wealthfront', 'ccAggrStatus': 0, 'exclusionType': '0', 'linkedAccount': None, 'isHiddenFromPlanningTrends': True, 'isTerminal': True, 'linkCreationTime': None, 'isActive': True, 'accountStatus': '1', 'accountSystemStatus': 'ACTIVE', 'lastUpdated': 1595796787000, 'fiLastUpdated': 1595796787000, 'yodleeAccountNumberLast4': 'My Roth IRA', 'isError': True, 'fiName': 'Wealthfront', 'isAccountNotFound': False, 'klass': 'invest', 'possibleLinkAccounts': [], 'lastUpdatedInString': '11 months', 'accountTypeInt': 66, 'currency': 'USD', 'id': 6216793, 'isHostAccount': False, 'value': 24060.59, 'fiLoginId': 2736811, 'usageType': None, 'interestRate': 0, 'accountType': 'investment', 'currentBalance': 24060.59, 'fiLoginStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'isAccountClosedByMint': False, 'userName': None, 'yodleeName': 'My Roth IRA', 'closeDate': 1595707164000, 'linkStatus': 'NOT_LINKED', 'accountId': 6216793, 'isClosed': False, 'fiLoginUIStatus': 'FAILED_INVALID_USER_CREDENTIALS', 'yodleeAccountId': 75115869139, 'name': 'My Roth IRA', 'status': '1', 'addAccountDateInDate': datetime.datetime(2016, 1, 3, 10, 8, 29), 'closeDateInDate': datetime.datetime(2020, 7, 25, 14, 59, 24), 'fiLastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'lastUpdatedInDate': datetime.datetime(2020, 7, 26, 15, 53, 7), 'availableMoney': None, 'totalFees': None, 'totalCredit': None, 'nextPaymentAmount': None, 'nextPaymentDate': None}]

b = {'income': [{'st': 1, 'ramt': 0, 'isIncome': True, 'isTransfer': False, 'isExpense': False, 'amt': 2364.69, 'pid': 30, 'type': 0, 'bgt': 4025.0, 'rbal': 1660.31, 'ex': False, 'cat': 'Paycheck', 'catName': 'Paycheck', 'id': 102443427, 'catTypeFilter': 'Personal', 'parent': 'Income'}],
 
 'spend': [{'st': 3, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 235.06, 'pid': 14, 'type': 0, 'bgt': 180.0, 'rbal': -55.06, 'ex': False, 'cat': 'Auto Insurance', 'catName': 'Auto Insurance', 'id': 102443415, 'catTypeFilter': 'Personal', 'parent': 'Auto & Transport'},
  {'st': 2, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 554.16, 'pid': 14, 'type': 0, 'bgt': 556.0, 'rbal': 1.84, 'ex': False, 'cat': 'Auto Payment', 'catName': 'Auto Payment', 'id': 102443426, 'catTypeFilter': 'Personal', 'parent': 'Auto & Transport'},
  {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 12, 'type': 0, 'bgt': 1560.0, 'rbal': 1560.0, 'ex': False, 'cat': 'Mortgage & Rent', 'catName': 'Mortgage & Rent', 'id': 102443419, 'catTypeFilter': 'Personal', 'parent': 'Home'},
   {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 170.0, 'pid': 11, 'type': 0, 'bgt': 462.0, 'rbal': 292.0, 'ex': False, 'cat': 'Investment Deposit', 'id': 102443425, 'catTypeFilter': 'Personal', 'parent': 'Financial'},
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 226.45, 'pid': 7, 'type': 0, 'bgt': 275.0, 'rbal': 48.55, 'ex': False, 'cat': 'Groceries', 'catName': 'Groceries', 'id': 102443420, 'catTypeFilter': 'Personal', 'parent': 'Food & Dining'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 7, 'type': 0, 'bgt': 150.0, 'rbal': 150.0, 'ex': False, 'cat': 'Restaurants', 'catName': 'Restaurants', 'id': 102443423, 'catTypeFilter': 'Personal', 'parent': 'Food & Dining'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 14, 'type': 0, 'bgt': 120.0, 'rbal': 120.0, 'ex': False, 'cat': 'Gas & Fuel', 'catName': 'Gas & Fuel', 'id': 102443431, 'catTypeFilter': 'Personal', 'parent': 'Auto & Transport'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 13, 'type': 0, 'bgt': 120.0, 'rbal': 120.0, 'ex': False, 'cat': 'Utilities', 'catName': 'Utilities', 'id': 102443421, 'catTypeFilter': 'Personal', 'parent': 'Bills & Utilities'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 49.0, 'pid': None, 'type': 0, 'bgt': 81.0, 'rbal': 32.0, 'ex': False, 'cat': 'Health & Fitness', 'catName': 'Health & Fitness', 'id': 102443430, 'catTypeFilter': 'Personal', 'parent': 'Root'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 19.44, 'pid': None, 'type': 0, 'bgt': 80.0, 'rbal': 60.56, 'ex': False, 'cat': 'Shopping', 'catName': 'Shopping', 'id': 102443429, 'catTypeFilter': 'Personal', 'parent': 'Root'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': None, 'type': 0, 'bgt': 80.0, 'rbal': 80.0, 'ex': False, 'cat': 'Education', 'catName': 'Education', 'id': 102443424, 'catTypeFilter': 'Personal', 'parent': 'Root'},
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 7, 'type': 0, 'bgt': 80.0, 'rbal': 80.0, 'ex': False, 'cat': 'Alcohol & Bars', 'catName': 'Alcohol & Bars', 'id': 102443417, 'catTypeFilter': 'Personal', 'parent': 'Food & Dining'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': None, 'type': 0, 'bgt': 60.0, 'rbal': 60.0, 'ex': False, 'cat': 'Entertainment', 'catName': 'Entertainment', 'id': 102443432, 'catTypeFilter': 'Personal', 'parent': 'Root'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': None, 'type': 0, 'bgt': 60.0, 'rbal': 60.0, 'ex': False, 'cat': 'Personal Care', 'catName': 'Personal Care', 'id': 102443422, 'catTypeFilter': 'Personal', 'parent': 'Root'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 23.52, 'pid': 7, 'type': 0, 'bgt': 50.0, 'rbal': 26.48, 'ex': False, 'cat': 'Fast Food', 'catName': 'Fast Food', 'id': 102443416, 'catTypeFilter': 'Personal', 'parent': 'Food & Dining'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 13, 'type': 0, 'bgt': 41.0, 'rbal': 41.0, 'ex': False, 'cat': 'Internet', 'catName': 'Internet', 'id': 102443418, 'catTypeFilter': 'Personal', 'parent': 'Bills & Utilities'}, 
    {'st': 1, 'ramt': 0, 'isIncome': False, 'isTransfer': False, 'isExpense': True, 'amt': 0, 'pid': 15, 'type': 0, 'bgt': 40.0, 'rbal': 40.0, 'ex': False, 'cat': 'Rental Car & Taxi', 'catName': 'Rental Car & Taxi', 'id': 102443428, 'catTypeFilter': 'Personal', 'parent': 'Travel'}]}



bills = [{'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': 'c52b0209-04d5-3922-b6cb-8cbb2bae22f3', 'contentAccountRef': '79fb33687147ae2cb28aa07af3739811', 'connectedAccounts': [{'contentProviderId': 2, 
'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': 'c52b0209-04d5-3922-b6cb-8cbb2bae22f3', 'contentAccountRef': '79fb33687147ae2cb28aa07af3739811'}]}, 'providerRef': {'providerId': 'da579b9a-a53a-4a0d-91e3-8cf9c75fca28', 'providerName': 'xfinity', 'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': None}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '55'}]}, 'model': 'REGULAR_BILL', 'dueDate': '2018-03-20', 'aggregationDueAmount': 0.0, 'dueAmount': 0.0, 'currency': 'USD', 'pastDueAmount': 0.0, 'statementAmount': 0.0, 'statementDate': '2018-02-28', 'billStatus': 'FULL', 'pastDueStatus': 'FALSE', 'isPayable': False, 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '8897093450193760206', 'billDetailsList': [{'billDetailsType': 'UTILITY', 'name': 'Payments', 'value': 228.7}], 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD', 'CREDIT_CARD'], 'id': '7326903310100285047', 'metaData': {'createdDate': '2017-01-13T20:44:20Z', 'link': [{'href': '/v2/payer/institutions/8897093450193760206', 'rel': 'institution'}]}}, {'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': '3034292192760981176', 'contentAccountRef': '75391669130', 'connectedAccounts': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'contentLoginRef': '7172b333-b65e-3872-b6f0-011be43e151a', 'contentAccountRef': 'urn:account:fdp::accountid:e594a788-a653-3e10-befe-706f2bcff320'}]}, 'providerRef': {'providerId': '75f8d952-be81-4e22-951e-41b291d211f2', 'providerName': 'American Express Corporate or Personal Credit Card (US)', 'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': '1002'}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '64'}]}, 'model': 'CREDIT_CARD', 'dueDate': '2021-07-21', 'aggregationDueAmount': 1591.23, 'dueAmount': 1591.23, 'currency': 'USD', 'statementAmount': 1591.23, 'statementDate': '2021-06-25', 'billStatus': 'NOT_PAID', 'pastDueStatus': 'FALSE', 'isPayable': False, 'lastDigits': '1003', 'minimumPaymentDue': 40.0, 'aggregationMinimumPaymentDue': 40.0, 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '3034292192760981176', 'lastPaymentDate': '2021-07-10', 'billDetailsList': [{'billDetailsType': 'CREDIT_CARD', 'name': 'Bonvoy Amex Card', 'number': '1003', 'availableBalanceAmount': 2305.6, 'availableBalanceType': 'DEBIT', 'creditLimit': 
10000.0, 'status': 'OTHER'}], 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD'], 'id': '4576616495530057800', 'metaData': {'createdDate': '2019-08-03T14:23:49Z', 'link': [{'href': '/v2/payer/institutions/3034292192760981176', 'rel': 
'institution'}]}}, {'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': 'dce6c3b2-aced-3977-9454-bb5f58eac7bb', 'contentAccountRef': '39c2342139fcc5e34c526b87022f7773', 'connectedAccounts': [{'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': 'dce6c3b2-aced-3977-9454-bb5f58eac7bb', 'contentAccountRef': '39c2342139fcc5e34c526b87022f7773'}]}, 'providerRef': {'providerId': 'f141569e-9e1b-4ad5-a8c7-8cb3d545703d', 'providerName': 'Progressive', 'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': None}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '155'}]}, 'model': 'INSURANCE', 'dueDate': '2020-02-03', 'aggregationDueAmount': 0.0, 'dueAmount': 0.0, 'currency': 'USD', 'pastDueAmount': 0.0, 'billStatus': 'FULL', 'pastDueStatus': 'FALSE', 'isPayable': False, 'lastDigits': '6768', 'autoPaid': True, 'accountNumber': '915556768', 'paymentResetDate': '2020-01-29T05:09:48.844+00:00', 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '1489353012757094401', 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD', 'CREDIT_CARD'], 'id': '2930261357954217868', 'metaData': {'createdDate': '2018-02-12T00:44:11Z', 'link': [{'href': '/v2/payer/institutions/1489353012757094401', 'rel': 'institution'}]}}, {'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': '7253342564148930261', 'contentAccountRef': '75370821235', 'connectedAccounts': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'contentLoginRef': '362a737e-5413-3bfb-9d20-0e164ca32442', 'contentAccountRef': 'urn:account:fdp::accountid:46d3fd5b-c157-37fe-997c-f700505f6122'}]}, 'providerRef': {'providerId': '5a386b71-bdf5-4c41-a1a5-3ad5d411cc8d', 'providerName': 'Honda Financial Services', 'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': '3755'}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '162'}]}, 'model': 'LOAN', 'dueDate': '2021-08-06', 'aggregationDueAmount': 554.16, 'dueAmount': 554.16, 'currency': 'USD', 'billStatus': 'NOT_PAID', 'pastDueStatus': 'FALSE', 'isPayable': False, 'lastDigits': '0727', 'autoPaid': True, 'accountNumber': '9719854306462430727', 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '7253342564148930261', 'lastPaymentDate': '2021-07-01', 'lastPaymentAmount': 554.16, 'billDetailsList': [{'billDetailsType': 'LOAN', 'name': 'XXXXX0727', 'currentBalance': 14683.41, 'payoffAmount': 14683.41, 'loanEndDate': '2023-11-06T16:00:00.000+00:00', 'remainingPayments': 28.0, 'loanStatus': 'OTHER'}], 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD'], 'id': '1890193819581491325', 'metaData': {'createdDate': '2019-08-03T14:23:49Z', 'link': [{'href': '/v2/payer/institutions/7253342564148930261', 'rel': 'institution'}]}}, {'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': '1497807465002559901', 'contentAccountRef': '75180217336', 'connectedAccounts': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'contentLoginRef': 'ad959858-ca3f-31a1-8b64-35475e18e88f', 'contentAccountRef': 'urn:account:fdp::accountid:ab4438b3-08c3-3a23-9c8e-4d52320ed969'}]}, 'providerRef': {'providerId': '7e3c2c96-44da-4d23-b966-2d34f65b3401', 'providerName': 'Capital One - Credit Cards', 'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': '1407'}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '2039'}]}, 'model': 'CREDIT_CARD', 'dueDate': '2020-09-14', 'aggregationDueAmount': 59.0, 'dueAmount': 
59.0, 'currency': 'USD', 'statementAmount': 59.0, 'statementDate': '2020-08-17', 'billStatus': 'NOT_PAID', 'pastDueStatus': 'FALSE', 'isPayable': False, 'lastDigits': '5671', 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '1497807465002559901', 'lastPaymentDate': '2019-09-14', 'lastPaymentAmount': 59.0, 'billDetailsList': [{'billDetailsType': 'CREDIT_CARD', 'name': 'Venture', 'number': '5671', 'availableBalanceAmount': 59.0, 'availableBalanceType': 'DEBIT', 'availableCredit': -59.0, 'status': 'OTHER'}], 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD'], 'id': '4658404481527747228', 'metaData': {'createdDate': '2019-08-03T14:23:47Z', 'link': [{'href': '/v2/payer/institutions/1497807465002559901', 'rel': 'institution'}]}}, {'contentAccountRef': {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'contentLoginRef': '5071473431000519851', 'contentAccountRef': '75398097885', 'connectedAccounts': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'contentLoginRef': '69c3abf1-bcfe-37c2-8193-1da7ccbcae07', 'contentAccountRef': 'urn:account:fdp::accountid:4e88cf07-a7e3-3e59-9c50-b87352dd789e'}]}, 'providerRef': {'providerId': '867c4a38-0d75-46ff-a4c2-f44cb63be2c9', 'providerName': 'Chase Bank', 
'contentProviderRef': [{'contentProviderId': 1, 'contentProviderName': 'Intuit FDS', 'providerId': '4'}, {'contentProviderId': 2, 'contentProviderName': 'Intuit Mint Bills', 'providerId': '2220'}]}, 'model': 'CREDIT_CARD', 'dueDate': '2021-08-02', 'aggregationDueAmount': 353.85, 'dueAmount': 353.85, 'currency': 'USD', 'statementAmount': 353.85, 'statementDate': '2021-07-05', 'billStatus': 'NOT_PAID', 'pastDueStatus': 'FALSE', 'isPayable': False, 'lastDigits': '0995', 'minimumPaymentDue': 40.0, 'aggregationMinimumPaymentDue': 40.0, 'autoPaid': True, 'isHistory': False, 'institutionType': 'LINKED', 'institutionId': '5071473431000519851', 'lastPaymentDate': '2021-07-02', 'lastPaymentAmount': 283.93, 'billDetailsList': [{'billDetailsType': 'CREDIT_CARD', 'name': 'CREDIT CARD', 'number': '0995', 'availableBalanceAmount': 353.85, 'availableBalanceType': 'DEBIT', 'creditLimit': 13000.0, 'purchasesApr': 22.99, 'status': 'OTHER'}], 'isVisible': True, 'allowedPaymentMethodOptions': ['ACH', 'DEBIT_CARD'], 'id': '6060316510470412721', 'metaData': {'createdDate': '2019-08-03T14:23:48Z', 'link': [{'href': '/v2/payer/institutions/5071473431000519851', 'rel': 'institution'}]}}]

# investments = {"6655506":{"isinactive":"false","cost":0.0,"inception":"Jan 3, 2016","description":"Wealthfront - My Personal Investment Account","isretirement":false,"isbrokerage":false,"sorted":{"performance-asc":[],"performance-dsc":[],"value":[],"movement":[]},"dormant":false,"changeValue":0.0,"id":"6655506","investmentType":"Investment, Taxable","holdings":{},"value":0.0},"cost":55410.25000000001,"inception":"Aug 22, 2013","5721028":{"isinactive":"false","cost":0.0,"inception":"Aug 22, 2013","description":"T. Rowe 
# Price Retirement Plan Services - CAMERON INTERNATIONAL CORP RETIREMENT SAVINGS PLAN","isretirement":true,"isbrokerage":false,"sorted":{"performance-asc":[],"performance-dsc":[],"value":[],"movement":[]},"dormant":true,"changeValue":0.0,"id":"5721028","investmentType":"401(k)","holdings":{},"value":0.0},"6825857":{"isinactive":"false","cost":29561.52,"inception":"Jan 3, 2016","description":"Charles Schwab - Roth Contributory IRA","isretirement":true,"isbrokerage":false,"sorted":{"performance-asc":["18594792","18594798","18594795","18594797","18601923","18574960"],"performance-dsc":["18574960","18601923","18594797","18594795","18594798","18594792"],"value":["18601923","18594797","18594798","18574960","18594792","18594795"],"movement":["18574960","18601923","18594797","18594795","18594798","18594792"]},"dormant":true,"changePercent":0.6333172313196346,"changeValue":18721.820000000003,"id":"6825857","investmentType":"401(k)","holdings":{"18594792":{"symbol":"EMB","cost":224.89999999999986,"inception":"Oct 13, 2020","description":"ISHARES JPMORGAN USD MTSBOND ETF","type":15,"transactions":[{"date":"May 07","shares":null,"amount":"$0.70","category":"Dividend"},{"date":"Jun 07","shares":null,"amount":"$0.72","category":"Dividend"},{"date":"Jul 08","shares":null,"amount":"$0.71","category":"Dividend"}],"shares":2.0,"price":111.82,"changePercent":-0.005602489995553037,"changeValue":-1.2599999999998772,"id":"18594792","value":223.64,"account":"6825857"},"18594795":{"symbol":"VWO","cost":45.12000000000012,"inception":"Oct 13, 2020","description":"VANGUARD FTSE EMERGING MARK ETF IV","type":15,"transactions":[{"date":"Jun 24","shares":null,"amount":"$0.28","category":"Dividend"},{"date":"Oct 20","shares":26.0,"amount":"$1,175.17","category":"None"},{"date":"Oct 20","shares":74.0,"amount":"$3,344.73","category":"None"}],"shares":1.0,"price":53.04,"changePercent":0.17553191489361392,"changeValue":7.919999999999881,"id":"18594795","value":53.04,"account":"6825857"},"18601923":{"symbol":"TSLA","cost":19004.7,"inception":"Oct 18, 2020","description":"TESLA INC","type":15,"transactions":[{"date":"Oct 15","shares":10.0,"amount":"$4,509.30","category":"None"},{"date":"Oct 30","shares":22.0,"amount":"$8,668.00","category":"None"},{"date":"Nov 02","shares":1.0,"amount":"$396.00","category":"None"}],"shares":47.0,"price":668.54,"changePercent":0.6533478560566597,"changeValue":12416.68,"id":"18601923","value":31421.38,"account":"6825857"},"18574960":{"shares":0.0,"symbol":"","cost":0.0,"price":null,"inception":"Oct 4, 2020","description":"Cash and Money Market","changeValue":3979.23,"id":"18574960","type":15,"transactions":[],"value":3979.23,"account":"6825857"},"18594798":{"symbol":"VIG","cost":4021.8,"inception":"Oct 13, 2020","description":"VANGUARD DIVIDEND APPRECIATIO ETF IV","type":15,"transactions":[{"date":"Jun 24","shares":null,"amount":"$20.25","category":"Dividend"},{"date":"Dec 24","shares":null,"amount":"$19.93","category":"Dividend"},{"date":"Mar 25","shares":null,"amount":"$15.39","category":"Dividend"}],"shares":30.0,"price":157.41,"changePercent":0.17417574220498283,"changeValue":700.5,"id":"18594798","value":4722.3,"account":"6825857"},"18594797":{"symbol":"VTI","cost":6265.0,"inception":"Oct 13, 2020","description":"VANGUARD TOTAL STOCK MARKET E ETF IV","type":15,"transactions":[{"date":"Jun 29","shares":null,"amount":"$23.64","category":"Dividend"},{"date":"Dec 30","shares":null,"amount":"$27.36","category":"Dividend"},{"date":"Mar 29","shares":null,"amount":"$300.00","category":"None"}],"shares":35.0,"price":225.25,"changePercent":0.25837988826815644,"changeValue":1618.75,"id":"18594797","value":7883.75,"account":"6825857"}},"value":48283.340000000004},"6661189":{"isinactive":"false","cost":1962.05,"inception":"Apr 4, 2019","description":"Fidelity - INDIVIDUAL","isretirement":false,"isbrokerage":false,"sorted":{"performance-asc":["17508846"],"performance-dsc":["17508846"],"value":["17508846"],"movement":["17508846"]},"dormant":false,"changePercent":0.0,"changeValue":0.0,"id":"6661189","investmentType":"Investment, Taxable","holdings":{"17508846":{"symbol":"SPAXX","cost":1962.05,"inception":"Apr 4, 2019","description":"FIDELITY GOVERNMENT MONEY MARKET","type":15,"transactions":[],"shares":1962.05,"price":1.0,"changePercent":0.0,"changeValue":0.0,"id":"17508846","value":1962.05,"account":"6661189"}},"value":1962.05},"sorted":{"performance-asc":["6825857-18594792","6216793-15771339","6216793-15771335","6661189-17508846","6216793-15771341","6825857-18594798","6825857-18594795","6825857-18594797","6834413-186417218883906813,"changeValue":13683.54,"id":"18641721","value":35432.62,"account":"6834413"},"18613735":{"shares":0.0,"symbol":"","cost":0.0,"price":null,"inception":"Oct 24, 2020","description":"Cash and Money Market","changeValue":4.76,"id":"18613735","type":15,"transactions":[],"value":4.76,"account":"6834413"}},"value":35437.380000000005},"segment":"multiple","showPopup":null,"changePercent":1.117761425007106,"changeValue":61935.439999999995,"value":117345.69,"6216793":{"isinactive":"false","cost":0.0,"inception":"Jan 3, 2016","description":"Wealthfront - My Roth IRA","isretirement":false,"isbrokerage":false,"sorted":{"performance-asc":["15771339","15771335","15771341"],"performance-dsc":["15771335","15771341","15771339"],"value":["15771341","15771335","15771339"],"movement":["15771339","15771335","15771341"]},"dormant":false,"changeValue":0.0,"id":"6216793","investmentType":"Investment, Taxable","holdings":{"15771339":{"symbol":"","cost":-7.77,"inception":"Feb 3, 2018","description":"Cash","type":15,"transactions":[],"shares":0.0,"price":null,"changePercent":-0.0,"changeValue":0.0,"id":"15771339","value":-7.77,"account":"6216793"},"15771335":{"symbol":"","cost":2.65,"inception":"Feb 3, 2018","description":"Corporate Bonds","type":15,"transactions":[],"shares":0.0,"price":null,"changePercent":0.0,"changeValue":0.0,"id":"15771335","value":2.65,"account":"6216793"},"15771341":{"symbol":"","cost":5.12,"inception":"Feb 3, 2018","description":"Emerging Market Bonds","type":15,"transactions":[],"shares":0.0,"price":null,"changePercent":0.0,"changeValue":0.0,"id":"15771341","value":5.12,"account":"6216793"}},"value":0.0},"lastDate":"Wed Jul 14 close"}


pp.pprint(bills)

test_df = pd.DataFrame(bills)

print(test_df.head())

print(test_df.info())

contentAccountRef_df = test_df['contentAccountRef']



# print('contentAccountRef_df')
# print(type(contentAccountRef_df))

df_to_list = contentAccountRef_df.to_list()

# print(df_to_list)


# contentAccountRef_dff = pd.DataFrame(df_to_list)
# print('contentAccountRef_dff')
# print(contentAccountRef_dff.head())




from pandas.io.json._normalize import nested_to_record

flat = nested_to_record(bills, sep='_')
flat_df = pd.DataFrame(flat)
print(flat_df)


# investments = '{"6655506":{"isinactive":"false","cost":0.0,"inception":"Jan 3, 2016","description":"Wealthfront - My Personal Investment Account","isretirement":False,"isbrokerage":False,"sorted":{"performance-asc":[],"performance-dsc":[],"value":[],"movement":[]},"dormant":False,"changeValue":0.0,"id":"6655506","investmentType":"Investment, Taxable","holdings":{},"value":0.0},"cost":55410.25,"inception":"Aug 22, 2013","5721028":{"isinactive":"false","cost":0.0,"inception":"Aug 22, 2013","description":"T. Rowe Price Retirement Plan Services - CAMERON INTERNATIONAL CORP RETIREMENT SAVINGS PLAN","isretirement":True,"isbrokerage":False,"sorted":{"performance-asc":[],"performance-dsc":[],"value":[],"movement":[]},"dormant":True,"changeValue":0.0,"id":"5721028","investmentType":"401(k)","holdings":{},"value":0.0},"6825857":{"isinactive":"false","cost":29561.519999999997,"inception":"Jan 3, 2016","description":"Charles Schwab - Roth Contributory IRA","isretirement":True,"isbrokerage":False,"sorted":{"performance-asc":["18594792","18594798","18594795","18594797","18601923","18574960"],"performance-dsc":["18574960","18601923","18594797","18594795","18594798","18594792"],"value":["18601923","18594797","18594798","18574960","18594792","18594795"],"movement":["18574960","18601923","18594797","18594795","18594798","18594792"]},"dormant":True,"changePercent":0.6171282802778746,"changeValue":18243.249999999993,"id":"6825857","investmentType":"401(k)","holdings":{"18594792":{"symbol":"EMB","cost":224.89999999999986,"inception":"Oct 13, 2020","description":"ISHARES JPMORGAN USD MTSBOND ETF","type":15,"transactions":[{"date":"May 07","shares":"","amount":"$0.70","category":"Dividend"},{"date":"Jun 07","shares":"","amount":"$0.72","category":"Dividend"},{"date":"Oct 14","shares":12.0,"amount":"$1,349.02","category":"None"}],"shares":2.0,"price":112.25,"changePercent":-0.0017785682525560864,"changeValue":-0.3999999999998636,"id":"18594792","value":224.5,"account":"6825857"},"18594795":{"symbol":"VWO","cost":45.12000000000012,"inception":"Oct 13, 2020","description":"VANGUARD FTSE EMERGING MARK ETF IV","type":15,"transactions":[{"date":"Jun 24","shares":"","amount":"$0.28","category":"Dividend"},{"date":"Oct 20","shares":26.0,"amount":"$1,175.17","category":"None"},{"date":"Oct 20","shares":74.0,"amount":"$3,344.73","category":"None"}],"shares":1.0,"price":52.99,"changePercent":0.1744237588652452,"changeValue":7.869999999999884,"id":"18594795","value":52.99,"account":"6825857"},"18601923":{"symbol":"TSLA","cost":19004.7,"inception":"Oct 18, 2020","description":"TESLA INC","type":15,"transactions":[{"date":"Oct 15","shares":10.0,"amount":"$4,509.30","category":"None"},{"date":"Oct 30","shares":22.0,"amount":"$8,668.00","category":"None"},{"date":"Nov 02","shares":1.0,"amount":"$396.00","category":"None"}],"shares":47.0,"price":659.58,"changePercent":0.6311891269001877,"changeValue":11995.559999999998,"id":"18601923","value":31000.26,"account":"6825857"},"18594798":{"symbol":"VIG","cost":4021.8,"inception":"Oct 13, 2020","description":"VANGUARD DIVIDEND APPRECIATIO ETF IV","type":15,"transactions":[{"date":"Jun 24","shares":"","amount":"$20.25","category":"Dividend"},{"date":"Dec 24","shares":null,"amount":"$19.93","category":"Dividend"},{"date":"Mar 25","shares":"","amount":"$15.39","category":"Dividend"}],"shares":30.0,"price":156.04,"changePercent":0.16395643741608226,"changeValue":659.3999999999996,"id":"18594798","value":4681.2,"account":"6825857"},"18574960":{"shares":0.0,"symbol":"","cost":0.0,"price":"","inception":"Oct 4, 2020","description":"Cash and Money Market","changeValue":3978.52,"id":"18574960","type":15,"transactions":[],"value":3978.52,"account":"6825857"},"18594797":{"symbol":"VTI","cost":6265.0,"inception":"Oct 13, 2020","description":"VANGUARD TOTAL STOCK MARKET E ETF IV","type":15,"transactions":[{"date":"Jun 29","shares":"","amount":"$23.64","category":"Dividend"},{"date":"Dec 30","shares":"","amount":"$27.36","category":"Dividend"},{"date":"Mar 29","shares":null,"amount":"$300.00","category":"None"}],"shares":35.0,"price":224.78,"changePercent":0.2557541899441341,"changeValue":1602.3000000000002,"id":"18594797","value":7867.3,"account":"6825857"}},"value":47804.76999999999},"6661189":{"isinactive":"false","cost":1962.05,"inception":"Apr 4, 2019","description":"Fidelity - INDIVIDUAL","isretirement":false,"isbrokerage":false,"sorted":{"performance-asc":["17508846"],"performance-dsc":["17508846"],"value":["17508846"],"movement":["17508846"]},"dormant":false,"changePercent":0.0,"changeValue":0.0,"id":"6661189","investmentType":"Investment, Taxable","holdings":{"17508846":{"symbol":"SPAXX","cost":1962.05,"inception":"Apr 4, 2019","description":"FIDELITY GOVERNMENT MONEY MARKET","type":15,"transactions":[],"shares":1962.05,"price":1.0,"changePercent":0.0,"changeValue":0.0,"id":"17508846","value":1962.05,"account":"6661189"}},"value":1962.05},"sorted":{"performance-asc":["6825857-18594792","6216793-15771339","6216793-15771335","6661189-17508846","6216793-15771341","6825857-18594798","6825857-18594795","6825857-18594797","6834413-18641721","6825857-18601923","6444597-14933658","6444597-14933659","6825857-18574960","6834413-18613735"],"performance-dsc":["6444597-14933659","6825857-18574960","6834413-18613735","6444597-14933658","6825857-18601923","6834413-186497-14933658","6825857-18601923","6834413-18641721","6825857-18594797","6825857-18594795","6825857-18594798","6825857-18594792","6216793-15771339","6216793-15771335","6661189-17508846","6216793-15771341"]},"6444597":{"isinactive":"false","cost":2137.6,"inception":"Jan 3, 2016","description":"Charles Schwab - Individual                       ","isretirement":false,"isbrokerage":false,"sorted":{"performance-asc":["14933658","14933659"],"performance-dsc":["14933659","14933658"],"value":["14933658","14933659"],"movement":["14933659","14933658"]},"dormant":false,"changePercent":13.632129491017965,"changeValue":29140.04,"id":"6444597","investmentType":"Investment, Taxable","holdings":{"14933658":{"symbol":"TSLA","cost":2137.6,"inception":"Jun 29, 2017","description":"TESLA INC","type":15,"transactions":[{"date":"Sep 23","shares":20.0,"amount":"$8,000.00","category":"None"},{"date":"Nov 10","shares":3.0,"amount":"$1,245.00","category":"None"}],"shares":43.0,"price":659.58,"changePercent":12.268123128742516,"changangeValue":0.0,"id":"15771339","value":-7.77,"account":"6216793"},"15771335":{"symbol":"","cost":2.65,"inception":"Feb 3, 2018","description":"Corporate Bonds","type":15,"transactions":[],"shares":0.0,"price":null,"changePercent":0.0,"changeValue":0.0,"id":"15771335","value":2.65,"account":"6216793"},"15771341":{"symbol":"","cost":5.12,"inception":"Feb 3, 2018","description":"Emerging Market Bonds","type":15,"transactions":[],"shares":0.0,"price":null,"changePercent":0.0,"changeValue":0.0,"id":"15771341","value":5.12,"account":"6216793"}},"value":4.440892098500626E-16},"lastDate":"Wed Jul 7 close"}'
# investments = investments.replace('null',"")
# investments = investments.replace('true','True')
# investments = investments.replace('false','False')

# pp.pprint(investments[0])






#  print(r[0])

temp_dict = r[0]

def findUnixDateKeys(sample_dict):

    unix_dates = []
    for key, value in sample_dict.items():
        # print(f'{key} is {value} and type {type(value)}')
        if isinstance(value, int) and len(str(value))==13:
            # print(f'{key} is an integer and length is {len(str(value))}')
            unix_dates.append(key)
        # print(value, '->', type(value), len(value))

    return unix_dates



def convert_response_to_unix_to_datetime_df(r):
    
    temp_df = pd.DataFrame.from_dict(r)

    datefields = findUnixDateKeys(r[0])
    for field in datefields:
        temp_df[field] = pd.to_datetime(temp_df[field], unit='ms')


    return temp_df


# val_df = convert_unix_to_datetime_df(r)

# print(val_df)

# # print(temp_df.iloc[:,26:])

# fields = ['addAccountDate', 'lastUpdated']

# temp_df['lastUpdated'] = pd.to_datetime(temp_df['lastUpdated'],unit='ms')
# temp_df['fiLastUpdated'] = pd.to_datetime(temp_df['fiLastUpdated'],unit='ms')

# print(temp_df.iloc[:,10:])

# subset_df = temp_df.iloc[:,0:3]

# print(subset_df)


# Example Python program to serialize a pandas DataFrame

# into a PostgreSQL table


         
# # Example connection     engine = create_engine("postgresql+psycopg2://user:pass@host/dbname?client_encoding=utf8")

# engine           = create_engine('postgresql+psycopg2://postgres:mysecretpassword@192.168.4.143/mint', pool_recycle=3600);

# postgreSQLConnection    = alchemyEngine.connect();

# postgreSQLTable         = "python_test3"



# try:

#     subset_df.to_sql(postgreSQLTable, postgreSQLConnection, if_exists='append');

# except ValueError as vx:

#     print(vx)

# except Exception as ex:  

#     print(ex)

# else:

#     print("PostgreSQL Table %s has been created successfully."%postgreSQLTable);

# finally:

#     postgreSQLConnection.close();